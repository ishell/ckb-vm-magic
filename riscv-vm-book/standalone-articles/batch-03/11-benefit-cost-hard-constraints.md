# 图 11-1 长文：收益-成本矩阵，架构决策如何避免“单边乐观”

## 摘要

图 11-1 的价值在于把“技术亮点”与“长期成本”放进同一张表。它迫使我们承认：区块链 VM 架构没有免费午餐，所有收益都对应维护负债。

## 1. 原图重述

```text
收益侧: 可验证执行 / 权限边界 / 可恢复执行 / 渐进优化
成本侧: 双后端一致性 / 计费校准 / 宿主集成复杂 / 侧信道审计
```

关键点：收益与成本应成对评估，不能只看一边。

## 2. 四个收益不是口号

1. **可验证执行**：错误语义结构化，可对拍
2. **权限边界清晰**：W^X 与页标志规则稳定
3. **可恢复执行**：快照机制支持分段推进
4. **渐进优化能力**：Rust 语义锚点 + ASM 快路径

这些收益都能映射到具体代码与测试机制，不是抽象愿景。

## 3. 四个成本不能回避

1. **双后端一致性成本**：每次语义变更都要双实现/双验证
2. **计费模型校准成本**：需持续对齐真实 workload
3. **宿主边界集成成本**：能力越多，边界治理越难
4. **侧信道审计成本**：确定性不等于恒时安全

架构成熟不是“消除成本”，而是“持续可管理成本”。

## 4. 决策误区

### 误区 A：只要性能提升就值得上线

在共识系统，语义风险权重通常高于性能收益。

### 误区 B：问题以后再补测试

后补测试往往追不上语义漂移速度。

### 误区 C：只看单次上线，不看升级链路

没有回滚预案的优化，都是潜在治理事故。

## 5. 可执行决策模型

建议每次重大改动都给出三表：

1. 语义影响表（可能改变哪些状态映射）
2. 经济影响表（cycles/费用曲线变化）
3. 治理影响表（升级、回滚、监控计划）

三表缺一，不应进入发布候选。

## 6. 指标体系建议

长期追踪指标：

- 后端差分失败率
- cycles 漂移率
- 兼容回归率
- 审计问题密度

指标的意义在于把“经验争论”转化为“数据对话”。

## 7. 与主文映射

- 对应章节：`第 11 章`
- 关键代码：`src/machine/mod.rs`, `src/memory/wxorx.rs`, `src/cost_model.rs`, `src/machine/asm/mod.rs`
- 关联附录：`附录 E`, `附录 G`

## 8. 一针见血结论

架构决策的专业性，不体现在“承诺更多收益”，而体现在“明确承担哪些成本并给出治理机制”。

