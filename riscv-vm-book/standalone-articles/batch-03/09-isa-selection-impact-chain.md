# 图 9-1 长文：ISA 选择影响链，不是性能偏好而是治理架构

## 摘要

图 9-1 表示“ISA -> 工具链 -> 实现一致性 -> 升级治理”的影响链。它告诉我们：在区块链 VM 中，ISA 不是底层实现细节，而是协议长期可维护性的起点。

## 1. 原图重述

```text
ISA selection
  -> compiler/toolchain
  -> contract ecosystem
  -> verifier/auditor cost
  -> protocol upgrade governance
```

该图的含义是“因果链”，不是“并列因素”。

## 2. 为什么共识系统对 ISA 更敏感

传统应用可接受局部平台差异，但共识系统不行。ISA 一旦确定，就会持续影响：

- 合约编译产物一致性
- 多后端执行一致性
- 审计工具与测试向量体系
- 版本升级与回滚复杂度

换句话说，ISA 选型错误会在多年后以治理成本形式显现。

## 3. RISC-V 在这条链上的优势

RISC-V 的工程优势不只“开放”二字，而是三件事同时成立：

1. 规范公开，便于多实现对拍
2. 编码规整，便于解码和形式化分析
3. 工具链生态稳定，便于长期维护

在 `ckb-vm` 中，这体现在 `IMC/B/A/MOP` 的组合可逐步演进，而不必推翻已有执行框架。

## 4. 工具链可复现是治理能力的一部分

若同版本源代码在不同环境编译产物不同，审计就会失效。建议固定并记录：

- 编译器版本
- 目标三元组与 ISA 标志
- 链接参数
- 产物哈希

这不是构建细节，而是协议证据链的一部分。

## 5. 反模式：以短期 benchmark 决定 ISA

仅用单机性能做决策，常见后果：

- 长期工具链维护成本被低估
- 多实现对拍成本被忽略
- 升级时回滚路径缺失

这类问题在第一年不明显，但在第三年会成为主成本。

## 6. 审计清单

1. 当前 ISA 子集是否有明确规范边界？
2. 是否存在可复现构建流程与产物记录？
3. 多后端是否有同输入一致性对拍？
4. 新扩展引入是否附版本门禁与回滚预案？

## 7. 与主文映射

- 对应章节：`第 9 章`
- 关键代码：`src/lib.rs`, `src/decoder.rs`, `build.rs`
- 关联附录：`附录 C`（扩展治理路线）

## 8. 一针见血结论

ISA 选择在共识系统里的本质，不是“跑更快”，而是“能否在十年尺度内保持可治理”。

