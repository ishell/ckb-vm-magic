# 90 分钟课程 Live Demo Runbook

## 一针见血原则

现场 demo 的目标不是“证明一切正常”，而是演示：当系统正常或异常时，我们都能给出可复核解释。

## 1. Demo 前检查（T-10 分钟）

### 1.1 环境与目录

```bash
cd /home/jay/Code/Rust/ckb-vm
pwd
rustc --version
cargo --version
```

### 1.2 脚本可用性

```bash
bash docs/riscv-vm-book/tools/run_labs.sh --help
bash -n docs/riscv-vm-book/tools/run_labs.sh
```

### 1.3 最小预热

```bash
cargo test --test test_simple -- --nocapture
```

## 2. 课堂主路径（建议 8-10 分钟）

### 2.1 执行命令

```bash
bash docs/riscv-vm-book/tools/run_labs.sh --batch 1 --mode smoke --skip-asm
```

### 2.2 讲解要点

按固定顺序解释：

1. 为什么选 batch 1：覆盖共识约束基础环节。
2. 为什么用 smoke：课堂时间受限，先看结构正确性。
3. 为什么 `--skip-asm`：避免机器差异打断教学主线。

### 2.3 展示产物

```bash
ls -lah docs/riscv-vm-book/reports/labs
# 进入最新目录后展示 md/csv/log
```

至少展示以下三项：

- `lab-run-report.md`：给评审看的全局视图。
- `lab-run-report.csv`：给自动化分析读取。
- `logs/*.log`：给排障定位使用。

## 3. 失败样本演示（建议 3-4 分钟）

如果现场没有自然失败，可用以下方式演示“如何处理失败”：

1. 打开历史失败日志（提前准备一份）。
2. 指出失败点属于哪一层：语义、计费、边界或环境。
3. 在白板写下“下一步动作”：复跑、缩小输入、补测试或回滚。

讲师禁忌：

- 不要说“我本地没复现所以问题不大”。
- 不要在课堂临时改代码掩盖失败。

## 4. 备用路径 A（asm 可用场景）

若机器支持 asm，可追加 1 条命令强化对比：

```bash
cargo test --features asm --test test_asm -- --nocapture
```

讲解重点：

- asm 通过并不自动代表语义正确，仍需差分与回归证据。

## 5. 备用路径 B（工具链异常场景）

如遇 rustup/权限异常，立即切换到“离线证据教学”：

1. 直接展示已生成的 `lab-run-report.md`。
2. 打开一条日志讲排障路径。
3. 把重点转回“证据解释能力”，而非“现场跑绿”。

推荐话术：

- “现场环境失败本身就是工程现实，我们要演示的是如何处理失败，而不是掩盖失败。”

## 6. 时间控制模板

| 阶段 | 预算时间 | 超时处理 |
|---|---:|---|
| 运行脚本命令 | 2 分钟 | 超时直接切到历史报告 |
| 展示报告结构 | 2 分钟 | 只看 md + 1 条 log |
| 展示失败定位 | 3 分钟 | 只讲一条失败路径 |
| 回填审计模板 | 2 分钟 | 口头说明，不现场填写完整 |

## 7. 课堂话术脚本（可直接照读）

- “请注意，我现在不是在验证性能高低，而是在验证证据链是否完整。”
- “报告里每个 case 都有目标语义，这是脚本化实验优于口头演示的关键。”
- “失败日志是资产，不是污点；没有失败样本就很难验证排障能力。”

## 8. Demo 后收口动作

1. 把报告目录路径发到课堂群。
2. 指定学员作业：任选 1 个 case，写 200 字失败/通过分析。
3. 要求学员在附录 F 模板中填写“证据链接”字段。

## 9. 风险清单与应对

| 风险 | 表现 | 应对 |
|---|---|---|
| 编译慢 | 首次运行时间过长 | 课前预热一次构建 |
| asm 不可用 | `--features asm` 失败 | 使用 `--skip-asm` 并说明边界 |
| 权限问题 | rustup 写入失败 | 切换离线报告讲解 |
| 输出噪声大 | 日志过长难讲解 | 预先标注关键行 |

## 10. 验收标准

一次课堂 demo 达标的最低标准：

- [ ] 至少执行 1 次脚本化实验命令
- [ ] 至少展示 1 份报告与 1 条原始日志
- [ ] 至少解释 1 个失败场景的定位路径
- [ ] 明确区分“课堂 smoke”与“发布 full”
